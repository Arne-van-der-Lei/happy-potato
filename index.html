<html>
	<head>
		<style type="text/css">
				*{
					margin: 0px;
					padding: 0px;
				}
				iframe{
					display: none;
				}

				body{
					width: 100%;
					height: 100%;
					overflow: hidden;
				}

				canvas{
					width: 100%;
					height: 100%;
				}
		</style>
	</head>
	<body>
		<iframe src="http://loli.dance/" frameborder ></iframe>
		<canvas id="happy" width="1920" height="1080"></canvas>

		<script>

		var canvas = document.getElementById('happy');
		var ctx = canvas.getContext('2d');

		var vent = {
			x:100,
			y:100,
			size:5,
			ymove:0,
			xmove:0,
			keyboard:true
		}

		function food (x,y,size,bad){
			this.x = x;
			this.y = y;
			this.size = size;
			this.bad = bad;
			this.draw = function(){
				ctx.beginPath();
			    ctx.arc(this.x, this.y, this.size, 0, Math.PI*2, true);
			    ctx.closePath();
			    ctx.fillStyle = this.bad ? "#C00" :"#000";
			    ctx.fill();
			}
		}

		var eatables = [];
		spawnEatable();
		function repaint () {
			window.requestAnimationFrame(repaint);
			ctx.fillStyle = 'rgba(255,255,255,0.3)';
			ctx.fillRect(0,0,canvas.width,canvas.height);
			var path = new Path2D();

			path.arc(vent.x,vent.y,Math.floor(vent.size),0,Math.PI*2,true); 
			ctx.stroke(path);
			ctx.fillStyle = "#000"
			ctx.font = "12px consolas";
  			ctx.fillText(Math.round(vent.size*100)/100, vent.x - (vent.size + "").length * 4,vent.y + vent.size*2 + 5)

			vent.x += vent.xmove;
			vent.y += vent.ymove;

			if(eatables.length == 0){
				spawnEatable();
			}
			if(eatables[eatables.length-1].bad ){
				spawnEatable();
			}
			for (var i = 0; i < eatables.length; i++) {
				if(CheckIfClose(eatables[i].x,eatables[i].y,vent.size,vent.x,vent.y)){
					vent.size += eatables[i].bad ? - eatables[i].size / 10 : eatables[i].size / 10 ;
					eatables.splice(i,1);
				}else{
					eatables[i].draw();
				}
			};
		}

		window.onkeydown = function(e) {
		    var key = e.keyCode ? e.keyCode : e.which;
		    //alert(key);
		    console.log(key)
		    if( vent.keyboard == true){
		        if (key == 81) {//left
		            vent.xmove = -1;
		        }else if (key == 90) {//up
		            vent.ymove = -1;
		        }else if (key == 68){//right
		            vent.xmove = 1;
		        }else if (key == 83){//down
		            vent.ymove = 1;
		        }else if(key == 65){
		        	vent.keyboard = vent.keyboard ? false:true;
		        }else {
		            vent.xmove = 0;
		            vent.ymove = 0;
		        }
		    }else{
		        if (key == 65) {//left
		            vent.xmove = -1;
		        }else if (key == 87) {//up
		            vent.ymove = -1;
		        }else if (key == 68){//right
		            vent.xmove = 1;
		        }else if (key == 83){//down
		            vent.ymove = 1;
		        }else if(key == 81){
		        	vent.keyboard = vent.keyboard ? false:true;
		        }else {
		            vent.xmove = 0;
		            vent.ymove = 0;
		        }
		    }


		}

		window.onkeyup = function(e) {
		    var key = e.keyCode ? e.keyCode : e.which;
		    //alert(key);
		    if(vent.keyboard == true){
		        if (key == 81) {//left
		            vent.xmove = 0;
		        }else if (key == 90) {//up
		            vent.ymove = 0;
		        }else if (key == 68){//right
		            vent.xmove = 0;
		        }else if (key == 83){//down
		            vent.ymove = 0;
		        }
		    }else{
		        if (key == 65) {//left
		            vent.xmove = 0;
		        }else if (key == 87) {//up
		            vent.ymove = 0;
		        }else if (key == 68){//right
		            vent.xmove = 0;
		        }else if (key == 83){//down
		            vent.ymove = 0;
		        }
		    }
		}

		function getRandomInt(min, max) {
		  return Math.floor(Math.random() * (max - min)) + min;
		}

		function CheckIfClose(x,y,size,dx,dy){
			if(Math.sqrt(Math.pow(x-dx,2)+Math.pow(y-dy,2))< size){
				return true;
			}
			return false;
		}

		function spawnEatable(){
			eatables.push(new food(getRandomInt(0,canvas.width),getRandomInt(0,canvas.height),getRandomInt(1,6),getRandomInt(0,2) == 0 ? true: false))
		}

		window.requestAnimationFrame(repaint);
		</script>
	</body>
</html>